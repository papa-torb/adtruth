var AdTruth=function(){"use strict";function t(){return"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function e(){const e="_adtruth_session";try{let i=sessionStorage.getItem(e);return i||(i=t(),sessionStorage.setItem(e,i)),i}catch(e){return t()}}const i=new class{constructor(){this.apiKey=null,this.apiEndpoint="https://api.adtruth.io/track",this.initialized=!1,this.debug=!1}init(t,e={}){this.initialized||(t?(this.apiKey=t,this.debug=e.debug||!1,e.endpoint&&(this.apiEndpoint=e.endpoint),this.initialized=!0,this.log("AdTruth: Initialized"),this.track()):this.log("AdTruth: API key is required"))}track(t="pageview"){if(!this.initialized)return void this.log("AdTruth: Not initialized. Call init() first.");const e=this.collectData(t);this.sendData(e)}collectData(t){const i=window.location.href,n=function(t){const e={};try{const i=new URL(t).searchParams;["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(t=>{const n=i.get(t);n&&(e[t]=n)});const n=i.get("gclid");n&&(e.gclid=n);const a=i.get("fbclid");a&&(e.fbclid=a)}catch(t){}return e}(i);return{event_type:t,timestamp:(new Date).toISOString(),session_id:e(),page:{url:i,title:document.title||"",referrer:document.referrer||""},utm:{source:n.utm_source||null,medium:n.utm_medium||null,campaign:n.utm_campaign||null,term:n.utm_term||null,content:n.utm_content||null},click_ids:{gclid:n.gclid||null,fbclid:n.fbclid||null},browser:{user_agent:navigator.userAgent,language:navigator.language||navigator.userLanguage||"",screen:{width:screen.width,height:screen.height},viewport:{width:window.innerWidth,height:window.innerHeight}}}}sendData(t){const e=JSON.stringify(t);if(navigator.sendBeacon){const t=new Blob([e],{type:"application/json"});if(navigator.sendBeacon(this.apiEndpoint,t))return void this.log("AdTruth: Data sent via sendBeacon")}this.sendViaFetch(e)}sendViaFetch(t){fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.apiKey},body:t,keepalive:!0}).then(()=>{this.log("AdTruth: Data sent via fetch")}).catch(t=>{this.log("AdTruth: Failed to send data",t)})}log(...t){this.debug&&"undefined"!=typeof console&&console.log&&console.log(...t)}},n={init:function(t,e){i.init(t,e)},trackPageview:function(){i.track("pageview")},track:function(t,e){i.track(t||"pageview")},version:"0.1.0"};
/**
   * AdTruth SDK - Open-source fraud detection for paid advertising
   * @version 0.1.0
   * @license MIT
   */return"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector("script[data-adtruth-api-key]");if(t){const e=t.getAttribute("data-adtruth-api-key"),i="true"===t.getAttribute("data-adtruth-debug");n.init(e,{debug:i})}}),n}();
